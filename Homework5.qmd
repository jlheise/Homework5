---
title: "Homework5"
author: "Jessie Heise"
format: pdf
editor: visual
---

## Task 1: Conceptual Questions

### 1. What is the purpose of using cross-validation when fitting a random forest model?

To avoid overfitting.

### 2. Describe the bagged tree algorithm.

The bagged tree algorithm fits many trees on bootstrap samples and combines the predictions.

### 3. What is meant by a general linear model?

A statistical model used on non-normal data.

### 4. When fitting a multiple linear regression model, what does adding an interaction term do? That is, what does it allow the model to do differently as compared to when it is not included in the model?

Allows for the effect of one variable to depend on the value of another.

### 5. Why do we split our data into a training and test set?

We want to be able to use models to predict well for observations it has yet to see and avoid overfitting the model based on the test data which is why the training set is used to traing the model and the test set is used to judge effectiveness of the model.

## Task 2: Data Prep

### Packages & Library

```{r, echo = FALSE, message = FALSE, warning = FALSE, include = FALSE}
library(tidyverse)
library(tidymodels)
library(caret)
library(yardstick)

# Read in csv data
heart_data <- read.csv('heart.csv')
```

### Run a report summary()

```{r}
summary(heart_data)
```

### Report summary questions

#### 1. What type of variable (in R) is Heart Disease? Categorical or Quantitative?

Numeric. Categorical.

#### 2. Does this make sense? Why or why not.

This does not make sense because the heart disease variable tells whether or not someone has heart disease- essentially a yes or a no. This data should not be numeric.

### Continued data prep

```{r}
# Change HeartDisease to logical, drop ST_Slope, HeartDisease
new_heart <- heart_data %>%
  mutate(HeartDisease_pres = as.logical(HeartDisease)) %>%
  select(-HeartDisease, -ST_Slope)
```

## Task 3: EDA

### Model someone's age as a function of heart disease and their max heart rate

```{r}
# Create appropriate scatterplot to visualize this relationship
ggplot2::ggplot(data = new_heart, aes(x= MaxHR, y = Age, color = HeartDisease_pres)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Age as a function of heart disease and maximum heart rate",
    x = "Maximum Heart Rate",
    y = "Age",
    color = "Presence of Heart Disease"
  ) +
  scale_color_viridis_d()
```

### Based on visual evidence, do you think an interaction model or an additive model is more appropriate?

Based on the visual evidence, an interactive model is more appropriate because the lines for presence of heart disease cross, suggesting an interactive effect.

## Task 4: Testing & Training

```{r}
# Split data into a training and test set. Seed = 101. 80-20 split.
set.seed(101)
heart_split <- initial_split(new_heart, prop = 0.8)
train <- training(heart_split)
test <- testing(heart_split)
```
